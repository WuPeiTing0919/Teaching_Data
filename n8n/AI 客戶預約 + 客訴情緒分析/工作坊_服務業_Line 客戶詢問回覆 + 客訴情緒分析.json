{
  "name": "å·¥ä½œåŠ_æœå‹™æ¥­_Line å®¢æˆ¶è©¢å•å›è¦† + å®¢è¨´æƒ…ç·’åˆ†æ",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "zeabur-test",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1968,
        320
      ],
      "id": "aff8a193-dba1-4eba-94e9-2b3a2eef792d",
      "name": "Webhook",
      "webhookId": ""
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=message : {{ $json.message }}\nuserID : {{ $json.userId }}\nreplyToken : {{ $json.replyToken }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸€å€‹å°ˆæ¥­çš„ AI å®¢æœåŠ©æ‰‹ï¼Œè«‹åˆ†æã€Œå®¢æˆ¶è¨Šæ¯ã€ä¸¦å›å‚³ JSON æ ¼å¼çš„çµæœã€‚\nè«‹å‹™å¿…ä¾ç…§ä»¥ä¸‹è¦å‰‡ï¼Œä¸è¦æ”¹è®Šæ¬„ä½åç¨±ï¼Œä¸è¦æ·»åŠ é¡å¤–å…§å®¹ã€‚\n\nmessageã€userIDã€replyToken å¸¶ prompt çš„å…§å®¹å³å¯ã€‚\n\nã€ä¸€ã€æ„åœ–åˆ†é¡ï¼ˆintentï¼‰ã€‘\nå¾ä¸‹åˆ—é¡å‹ä¸­é¸å‡ºä¸€ç¨®ï¼š\n1. reservation       ï¼ˆé ç´„ï¼‰\n2. inquiry           ï¼ˆä¸€èˆ¬è©¢å• / ç”¢å“ / åƒ¹æ ¼ / æœå‹™ï¼‰\n3. cancel            ï¼ˆå–æ¶ˆï¼‰\n4. complaint         ï¼ˆå®¢è¨´ / ä¸æ»¿ / æŠ±æ€¨ï¼‰\n5. greeting          ï¼ˆå•å€™ï¼‰\n6. irrelevant        ï¼ˆç„¡é—œ / é›œè¨Š / å»£å‘Šï¼‰\n7. other             ï¼ˆç„¡æ³•åˆ†é¡ï¼‰\n\nã€äºŒã€æƒ…ç·’åˆ†æï¼ˆsentimentï¼‰ã€‘\nå¾ä¸‹åˆ—ä¸‰ç¨®é¸ä¸€é …ï¼š\n- positive\n- neutral\n- negative\n- very_negative   ï¼ˆå¼·çƒˆè² é¢ï¼Œéœ€äººå·¥è™•ç†ï¼‰\n\nã€ä¸‰ã€æ€¥è¿«ç¨‹åº¦ï¼ˆurgencyï¼‰ã€‘\n- low\n- medium\n- high      ï¼ˆéœ€è¦ç«‹å³äººå·¥ä»‹å…¥ï¼‰\nèªªæ˜ï¼šç•¶ sentiment = very_negative æˆ– å®¢è¨´å…§å®¹å¼·çƒˆ â†’ urgency = high\n\nã€å››ã€è‡ªå‹•å›è¦†è¨Šæ¯ï¼ˆreplyï¼‰ã€‘\nä¾ç…§åˆ†é¡èˆ‡æƒ…ç·’ï¼Œè‡ªå‹•ç”¢ç”Ÿé©ç•¶å›è¦†ã€‚\n\nã€äº”ã€å›å‚³æ ¼å¼ï¼ˆè«‹å‹™å¿…ç…§æ­¤æ ¼å¼è¼¸å‡ºï¼‰ã€‘\n{  \n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"intent\": \"\",\n  \"sentiment\": \"\",\n  \"urgency\": \"\",\n  \"reply\": \"\"\n}\n\nâ—çµ•å°ç¦æ­¢ï¼š\n- åœ¨ JSON å‰å¾Œå¢åŠ ä»»ä½•ä¸­æ–‡ã€èªªæ˜ã€è§£æã€å®¢å¥—èª\n- è¼¸å‡º Markdownã€è¡¨æ ¼ã€æ–‡å­—æ®µè½\n- åœ¨ JSON å‰å¾ŒåŠ å…¥å¤šé¤˜ç¬¦è™Ÿæˆ–æ›è¡Œ\n\nä½ åªèƒ½è¼¸å‡º ç´” JSONã€‚"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -1520,
        320
      ],
      "id": "b9fd050a-2b27-46d8-ac39-3a3a0bd898f0",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "affdf30e-ce32-4052-acb7-5640ff15e2a5",
              "name": "userId",
              "value": "={{ $json.body.events[0].source.userId }}",
              "type": "string"
            },
            {
              "id": "5c8f69d5-b4ff-40b4-9af4-85600ad96464",
              "name": "message",
              "value": "={{ $json.body.events[0].message.text }}",
              "type": "string"
            },
            {
              "id": "4e1dbaa5-2c52-496d-926a-e2eb80e6460a",
              "name": "replyToken",
              "value": "={{ $json.body.events[0].replyToken }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1744,
        320
      ],
      "id": "de49e302-97d0-4a6d-a89e-27b1b50855c4",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": "reservation",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "e43c765d-796c-4f17-9a28-6f8a71dff44b"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "é ç´„æµç¨‹"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3f26edb7-ed6b-4abe-96d4-7fd778f0a430",
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": "inquiry",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ä¸€èˆ¬è©¢å•"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9b577b20-118b-4bc7-859b-43f0fb525048",
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": "cancel",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "å–æ¶ˆ"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7e51d8dd-0ed6-4679-8620-13561d5c3330",
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": "complaint",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "å®¢è¨´"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7809971d-1b5d-4aa7-a337-c5478297ac90",
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": "greeting",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "å•å€™"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bc5df681-62cd-4b22-b6cd-2351c1015b8b",
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": " irrelevant",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ç„¡é—œ"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "20ac6e05-3382-4595-9035-365e73dc6398",
                    "leftValue": "={{ $json.output.intent }}",
                    "rightValue": "other",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "å…¶ä»–"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -1168,
        240
      ],
      "id": "ada7e624-b1f5-44bc-ab11-5495b8533561",
      "name": "Switch"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{  \n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"intent\": \"\",\n  \"sentiment\": \"\",\n  \"urgency\": \"\",\n  \"reply\": \"\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -1392,
        544
      ],
      "id": "9d53f210-fa71-4a2c-800a-637504af7cf0",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $('Edit Fields').item.json.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"{{ $('AI Agent').item.json.output.reply }}\" \n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -1968,
        -1008
      ],
      "id": "27801955-9b21-4b5c-86bf-c296464210ca",
      "name": "HTTP Request1",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $('Edit Fields').item.json.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"æ‚¨å¥½ï¼è«‹å•ä»Šå¤©æƒ³äº†è§£ä»€éº¼å‘¢ï¼ŸğŸ˜Š\" \n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -832,
        720
      ],
      "id": "0abfd26b-d1af-41c7-a17a-0f8a609f8fc6",
      "name": "HTTP Request",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $('Edit Fields').item.json.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"æˆ‘æœ‰é»ä¸å¤ªç¢ºå®šæ‚¨çš„æ„æ€ ğŸ˜… å¦‚æœæ‚¨æƒ³é ç´„ï¼Œè«‹è¼¸å…¥ï¼šé ç´„ + æ—¥æœŸæ™‚é–“ï¼Œå¦‚æœæ‚¨è¦è©¢å•å•é¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥å‘Šè¨´æˆ‘å–”ï¼\" \n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -832,
        912
      ],
      "id": "18752f3d-8772-4f22-aeb1-e0637513f5a1",
      "name": "HTTP Request2",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Edit Fields').item.json.message }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸€å€‹å°ˆé–€è™•ç†é ç´„æµç¨‹çš„ AI åŠ©æ‰‹ã€‚\nè«‹ä¾ç…§ä½¿ç”¨è€…è¼¸å…¥çš„è¨Šæ¯ï¼Œå”åŠ©å®Œæˆé ç´„ã€Œè³‡æ–™æ”¶é›†ã€æ™‚é–“è§£æã€ç¢ºèªå•é¡Œã€ã€‚\n\nè«‹å‹™å¿…å›å‚³ JSON æ ¼å¼ï¼Œä¸è¦æ·»åŠ å…¶ä»–æ–‡å­—ã€‚\n\nã€ä½ çš„ä»»å‹™ã€‘\n1. åˆ¤æ–·ä½¿ç”¨è€…æ˜¯å¦æ­£åœ¨é ç´„ã€‚\n2. è‹¥ä½¿ç”¨è€…æä¾›è‡ªç„¶èªè¨€æ™‚é–“ï¼ˆä¾‹å¦‚ï¼šæ˜å¤©ä¸‹åˆã€ä¸‹é€±ä¸€æ—©ä¸Šï¼‰ï¼Œè«‹ä½¿ç”¨ n8n çš„ Date & Time å·¥å…·å°‡æ™‚é–“è½‰æ›ç‚ºæ¨™æº–æ ¼å¼ï¼ˆYYYY-MM-DD HH:mmï¼‰ã€‚\n3. è‹¥ç¼ºä¹å¿…è¦è³‡è¨Šï¼Œè«‹ä¸»å‹•è©¢å•ï¼š\n   - é ç´„æ—¥æœŸ\n   - é ç´„æ™‚é–“\n   - é ç´„é …ç›®ï¼ˆè‹¥å•†å®¶æœ‰ä¸åŒæœå‹™ï¼‰\n4. è‹¥è³‡è¨Šé½Šå…¨ï¼Œå‰‡ç”¢ç”Ÿé ç´„ç¢ºèªè¨Šæ¯ã€‚\n\nã€å¿…è¦æ¬„ä½ã€‘\nè«‹å‹™å¿…å›å‚³ä»¥ä¸‹ JSONï¼ˆæ ¼å¼ä¸å¯æ”¹ï¼‰ï¼š\n\n{\n  \"isReservation\": true/false,     // åˆ¤æ–·æ˜¯å¦ç‚ºé ç´„\n  \"missingFields\": [],             // ç¼ºå°‘å“ªäº›è³‡è¨Šï¼š[\"date\", \"time\", \"service\"]\n  \"date\": \"\",                      // YYYY-MM-DD æ ¼å¼ï¼Œè‹¥ä½¿ç”¨è‡ªç„¶èªè¨€è«‹è½‰æ›\n  \"time\": \"\",                      // HH:mm æ ¼å¼\n  \"service\": \"\",                   // é ç´„é …ç›®ï¼ˆå¦‚ï¼šå‰ªé«®ã€è«®è©¢ã€æŒ‰æ‘©ï¼‰\n  \"reply\": \"\"                      // è¦å›è¦†çµ¦ä½¿ç”¨è€…çš„è¨Šæ¯ï¼Œç”¨ä¸­æ–‡\n}\n\nã€è¦å‰‡ã€‘\n- è‹¥ä½¿ç”¨è€…æ²’æœ‰æ˜ç¢ºèªªè¦é ç´„ â†’ isReservation = false\n- è‹¥ä½¿ç”¨è€…èªªã€Œæˆ‘è¦5/20 ä¸‹åˆ2é»å‰ªé«®ã€â†’ å¡«æ»¿å…¨éƒ¨æ¬„ä½\n- è‹¥ä½¿ç”¨è€…åªèªªã€Œè¦é ç´„ã€â†’ missingFields = [\"date\", \"time\", \"service\"]\n- è‹¥ä½¿ç”¨è€…èªªã€Œæ˜å¤©ä¸‹åˆæŒ‰æ‘©ã€â†’ è§£æè‡ªç„¶èªè¨€æ™‚é–“ï¼Œservice=æŒ‰æ‘©\n- è‹¥ä½¿ç”¨è€…æä¾›éŒ¯èª¤æ ¼å¼ â†’ è«‹è¦æ±‚é‡æ–°ç¢ºèª\n- reply æ¬„ä½è¦å‹å–„ã€æœ‰ç¦®ã€æ¸…æ¥šæŒ‡å¼•ä¸‹ä¸€æ­¥\n\nã€ç¤ºä¾‹è¼¸å…¥èˆ‡è¼¸å‡ºã€‘\n\nä½¿ç”¨è€…ï¼šã€Œæˆ‘æƒ³é ç´„æ˜å¤©ä¸‹åˆåšè‡‰ã€\nè¼¸å‡ºï¼š\n{\n  \"isReservation\": true,\n  \"missingFields\": [],\n  \"date\": \"2025-01-17\",\n  \"time\": \"14:00\",\n  \"service\": \"åšè‡‰\",\n  \"reply\": \"å¥½çš„ï¼Œå·²ç‚ºæ‚¨ç¢ºèªæ˜å¤©ä¸‹åˆ 14:00 çš„åšè‡‰æœå‹™ã€‚è«‹å•æ˜¯å¦éœ€è¦ä¿®æ”¹ï¼Ÿ\"\n}\n\nä½¿ç”¨è€…ï¼šã€Œæˆ‘è¦é ç´„ä½†æˆ‘é‚„æ²’æ±ºå®šæ™‚é–“ã€\nè¼¸å‡ºï¼š\n{\n  \"isReservation\": true,\n  \"missingFields\": [\"date\", \"time\"],\n  \"date\": \"\",\n  \"time\": \"\",\n  \"service\": \"\",\n  \"reply\": \"å¥½çš„ï¼è«‹å‘Šè¨´æˆ‘æ‚¨å¸Œæœ›çš„é ç´„æ—¥æœŸèˆ‡æ™‚é–“ï¼Œæˆ‘å¯ä»¥å¹«æ‚¨å®‰æ’å–”ï½\"\n}\n\nä½¿ç”¨è€…ï¼šã€Œä½ å€‘æœ‰ç‡Ÿæ¥­åˆ°å¹¾é»ï¼Ÿã€\nè¼¸å‡ºï¼š\n{\n  \"isReservation\": false,\n  \"missingFields\": [],\n  \"date\": \"\",\n  \"time\": \"\",\n  \"service\": \"\",\n  \"reply\": \"æˆ‘å€‘ç‡Ÿæ¥­æ™‚é–“ç‚ºæ¯æ—¥ 10:00â€“20:00ï¼Œæ­¡è¿å†å‘Šè¨´æˆ‘æ‚¨æ˜¯å¦éœ€è¦é ç´„ï¼\"\n}\n\nâ—çµ•å°ç¦æ­¢ï¼š\n- åœ¨ JSON å‰å¾Œå¢åŠ ä»»ä½•ä¸­æ–‡ã€èªªæ˜ã€è§£æã€å®¢å¥—èª\n- è¼¸å‡º Markdownã€è¡¨æ ¼ã€æ–‡å­—æ®µè½\n- åœ¨ JSON å‰å¾ŒåŠ å…¥å¤šé¤˜ç¬¦è™Ÿæˆ–æ›è¡Œ\n\nä½ åªèƒ½è¼¸å‡º ç´” JSONã€‚"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -896,
        -784
      ],
      "id": "c0c12e16-f5a2-4dfd-b753-6453b974f18b",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.dateTimeTool",
      "typeVersion": 2,
      "position": [
        -816,
        -560
      ],
      "id": "efa18231-79d6-4bed-b4d0-94582920535b",
      "name": "Date & Time"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "sheetName": {
          "__rl": true,
          "value": 421740440,
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('Edit Fields').item.json.userId }}",
            "æ—¥æœŸ": "={{ $json.output.date }}",
            "æ™‚é–“": "={{ $json.output.time }}",
            "å“é …": "={{ $json.output.service }}",
            "ReplyToken": "={{ $('Edit Fields').item.json.replyToken }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ReplyToken",
              "displayName": "ReplyToken",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "æ—¥æœŸ",
              "displayName": "æ—¥æœŸ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æ™‚é–“",
              "displayName": "æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å“é …",
              "displayName": "å“é …",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æ˜¯å¦å–æ¶ˆé ç´„",
              "displayName": "æ˜¯å¦å–æ¶ˆé ç´„",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -256,
        -752
      ],
      "id": "2d4c90f0-a1fe-4234-891f-d27bc96bf6d4",
      "name": "Append row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"isReservation\": true,\n  \"missingFields\": [],\n  \"date\": \"2025-01-17\",\n  \"time\": \"14:00\",\n  \"service\": \"åšè‡‰\",\n  \"reply\": \"å¥½çš„ï¼Œå·²ç‚ºæ‚¨ç¢ºèªæ˜å¤©ä¸‹åˆ 14:00 çš„åšè‡‰æœå‹™ã€‚è«‹å•æ˜¯å¦éœ€è¦ä¿®æ”¹ï¼Ÿ\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -688,
        -560
      ],
      "id": "9d71b927-a320-4007-9373-c29a2ab4a108",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "2bcc9eb5-36ee-4206-a521-96a3a0f5e889",
              "leftValue": "={{ $json.output.missingFields }}",
              "rightValue": "",
              "operator": {
                "type": "array",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -480,
        -688
      ],
      "id": "f113249c-5eb9-45fa-9377-ac04a222ae19",
      "name": "If"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $('Edit Fields').item.json.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"{{ $('AI Agent1').item.json.output.reply }}\"\n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -32,
        -688
      ],
      "id": "7a52cbe1-0c5f-4034-b81c-117474531533",
      "name": "HTTP Request3",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=message : {{ $json.output.message }}\nuserID : {{ $json.output.userID }}\nReplyToken : {{ $json.output.replyToken }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸€å€‹å°ˆé–€è™•ç†ã€Œå–æ¶ˆé ç´„ã€çš„æ™ºæ…§åŠ©ç†ã€‚\nè«‹ä¾ç…§ä½¿ç”¨è€…è¼¸å…¥å…§å®¹ï¼Œåˆ¤æ–·æ˜¯å¦è¦å–æ¶ˆé ç´„ï¼Œä¸¦å”åŠ©å®Œæˆå–æ¶ˆæµç¨‹ã€‚\n\nè«‹å‹™å¿…å›å‚³ JSON æ ¼å¼ï¼ˆä¸å¯åŠ å…¥å¤šé¤˜æ–‡å­—ï¼‰ã€‚\nmessageã€userIDã€replyToken å¸¶ prompt çš„å…§å®¹å³å¯ã€‚\n\nã€ä½ çš„ä»»å‹™ã€‘\n1. åˆ¤æ–·ä½¿ç”¨è€…æ˜¯å¦æ­£åœ¨å–æ¶ˆé ç´„ã€‚\n2. è‹¥ä½¿ç”¨è€…æä¾›é ç´„æ—¥æœŸ / æ™‚é–“ / é …ç›®ç­‰è³‡è¨Šï¼Œè«‹å”åŠ©è§£æã€‚\n3. ä½¿ç”¨è€…è‹¥æœªèªªæ˜è¦å–æ¶ˆå“ªä¸€ç­†ï¼ˆå¦‚åŒä¸€å¤©å¤šç­†ï¼‰ï¼Œè«‹ä¸»å‹•è©¢å•ã€‚\n4. è‹¥ä½¿ç”¨è€…èªªã€Œå–æ¶ˆé ç´„ã€ã€ã€Œæˆ‘è¦å–æ¶ˆã€ã€ã€Œæˆ‘ä¸å»äº†ã€â†’ è¦–ç‚ºå–æ¶ˆæ„åœ–ã€‚\n5. è‹¥ç¼ºä¹é—œéµè³‡è¨Šï¼Œè«‹æä¾›æ­£ç¢ºçš„è©¢å•æŒ‡å¼•ã€‚\n6. è‹¥æ˜ç¢ºè³‡è¨Šè¶³å¤ ï¼Œè«‹ç”Ÿæˆä¸€æ®µå–æ¶ˆç¢ºèªè¨Šæ¯ã€‚\n\nã€å¿…è¦æ¬„ä½ã€‘\nè«‹å‹™å¿…å›å‚³ä»¥ä¸‹ JSONï¼ˆæ ¼å¼ä¸å¯æ›´æ”¹ï¼‰ï¼š\n\n{\n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"isCancel\": true/false,          // åˆ¤æ–·æ˜¯å¦ç‚ºå–æ¶ˆé ç´„\n  \"missingFields\": [],             // ç¼ºå°‘å“ªäº›æ¬„ä½ï¼š[\"date\", \"time\", \"service\"]\n  \"date\": \"\",                      // YYYY-MM-DD\n  \"time\": \"\",                      // HH:mm\n  \"service\": \"\",                   // æœå‹™é …ç›®ï¼ˆå¦‚ï¼šå‰ªé«®ã€æŒ‰æ‘©ï¼‰\n  \"reply\": \"\"                      // éœ€è¦å›è¦†çµ¦å®¢æˆ¶çš„æ–‡å­—\n}\n\nã€è¦å‰‡ã€‘\n- è‹¥ä½¿ç”¨è€…æ²’æœ‰è¡¨é”ã€Œå–æ¶ˆã€æ„åœ– â†’ isCancel = false\n- è‹¥ä½¿ç”¨è€…èªªã€Œå–æ¶ˆæ˜å¤©ä¸‹åˆæŒ‰æ‘©ã€â†’ è‡ªå‹•è§£ææˆæ—¥æœŸï¼‹æ™‚é–“ï¼‹æœå‹™åç¨±\n- è‹¥ä½¿ç”¨è€…åªèªªã€Œå–æ¶ˆé ç´„ã€â†’ missingFields = [\"date\", \"time\", \"service\"]\n- è‹¥ä½¿ç”¨è€…èªªã€Œä¸è¦ 2/20 çš„é‚£å€‹äº†ã€â†’ è«‹è§£æå‡ºæ—¥æœŸï¼ˆè‹¥å¯èƒ½ï¼‰ï¼Œä¸¦æ‰¾å‡ºç¼ºå°‘çš„è³‡è¨Š\n- è‹¥ä½¿ç”¨è€…è¡¨é”æ¨¡ç³Š â†’ è«‹å›è¦†æ¸…æ¥šè©¢å•ï¼šã€Œè«‹å•æ‚¨è¦å–æ¶ˆçš„æ˜¯å“ªä¸€å¤©èˆ‡å“ªå€‹æ™‚æ®µçš„é ç´„å‘¢ï¼Ÿã€\n\nã€è¼¸å‡ºç¤ºä¾‹ã€‘\n\nä½¿ç”¨è€…ï¼šã€Œæˆ‘è¦å–æ¶ˆ 2025/01/18 çš„æŒ‰æ‘©é ç´„ã€\nè¼¸å‡ºï¼š\n{\n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"isCancel\": true,\n  \"missingFields\": [],\n  \"date\": \"2025-01-18\",\n  \"time\": \"\",\n  \"service\": \"æŒ‰æ‘©\",\n  \"reply\": \"å¥½çš„ï¼Œæˆ‘å·²å¹«æ‚¨æ¨™è¨˜è¦å–æ¶ˆ 2025/01/18 çš„æŒ‰æ‘©æœå‹™ã€‚è«‹å•éœ€è¦å–æ¶ˆç‰¹å®šæ™‚é–“å—ï¼Ÿ\"\n}\n\nä½¿ç”¨è€…ï¼šã€Œå–æ¶ˆæ˜å¤©ä¸‹åˆçš„é ç´„ã€\nè¼¸å‡ºï¼š\n{\n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"isCancel\": true,\n  \"missingFields\": [],\n  \"date\": \"2025-01-17\",\n  \"time\": \"14:00\",\n  \"service\": \"\",\n  \"reply\": \"å¥½çš„ï¼Œæˆ‘å·²è¨˜ä¸‹æ‚¨è¦å–æ¶ˆæ˜å¤©ä¸‹åˆ 14:00 çš„é ç´„ã€‚è«‹å•æ˜¯å“ªä¸€é …æœå‹™å‘¢ï¼Ÿ\"\n}\n\nä½¿ç”¨è€…ï¼šã€Œæˆ‘è¦å–æ¶ˆé ç´„ã€\nè¼¸å‡ºï¼š\n{\n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"isCancel\": true,\n  \"missingFields\": [\"date\", \"time\", \"service\"],\n  \"date\": \"\",\n  \"time\": \"\",\n  \"service\": \"\",\n  \"reply\": \"å¥½çš„ï¼è«‹å‘Šè¨´æˆ‘æ‚¨è¦å–æ¶ˆçš„é ç´„æ—¥æœŸã€æ™‚é–“èˆ‡æœå‹™å…§å®¹ï¼Œæˆ‘ä¾†ç‚ºæ‚¨è™•ç†ã€‚\"\n}\n\nä½¿ç”¨è€…ï¼šã€Œæˆ‘åªæ˜¯æƒ³å•ä¸€ä¸‹ç‡Ÿæ¥­æ™‚é–“ã€\nè¼¸å‡ºï¼š\n{\n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"isCancel\": false,\n  \"missingFields\": [],\n  \"date\": \"\",\n  \"time\": \"\",\n  \"service\": \"\",\n  \"reply\": \"æˆ‘å€‘ç‡Ÿæ¥­æ™‚é–“ç‚ºæ¯æ—¥ 10:00â€“20:00ï¼Œæ­¡è¿å‘Šè¨´æˆ‘æ‚¨æ˜¯å¦éœ€è¦é ç´„æˆ–å–æ¶ˆé ç´„ã€‚\"\n}\n\nâ—çµ•å°ç¦æ­¢ï¼š\n- åœ¨ JSON å‰å¾Œå¢åŠ ä»»ä½•ä¸­æ–‡ã€èªªæ˜ã€è§£æã€å®¢å¥—èª\n- è¼¸å‡º Markdownã€è¡¨æ ¼ã€æ–‡å­—æ®µè½\n- åœ¨ JSON å‰å¾ŒåŠ å…¥å¤šé¤˜ç¬¦è™Ÿæˆ–æ›è¡Œ\n\nä½ åªèƒ½è¼¸å‡º ç´” JSONã€‚"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -896,
        16
      ],
      "id": "ade0c155-46e9-49e2-926d-ef13d77e8b2e",
      "name": "AI Agent2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.dateTimeTool",
      "typeVersion": 2,
      "position": [
        -816,
        240
      ],
      "id": "2e7e09ad-21a6-4543-95d8-f289f4ae0b8a",
      "name": "Date & Time1"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"message\":\"\",\n  \"userID\":\"\",\n  \"replyToken\":\"\",\n  \"isCancel\": true,\n  \"missingFields\": [],\n  \"date\": \"2025-01-18\",\n  \"time\": \"\",\n  \"service\": \"æŒ‰æ‘©\",\n  \"reply\": \"å¥½çš„ï¼Œæˆ‘å·²å¹«æ‚¨æ¨™è¨˜è¦å–æ¶ˆ 2025/01/18 çš„æŒ‰æ‘©æœå‹™ã€‚è«‹å•éœ€è¦å–æ¶ˆç‰¹å®šæ™‚é–“å—ï¼Ÿ\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -688,
        240
      ],
      "id": "f6a9eafd-b380-426a-8f45-be93ec4437db",
      "name": "Structured Output Parser2"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "2bcc9eb5-36ee-4206-a521-96a3a0f5e889",
              "leftValue": "={{ $json.output.missingFields }}",
              "rightValue": "",
              "operator": {
                "type": "array",
                "operation": "empty",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -480,
        128
      ],
      "id": "4f90e473-f98d-4697-a4d1-26e5668b7115",
      "name": "If1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "sheetName": {
          "__rl": true,
          "value": 421740440,
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "UserID",
              "lookupValue": "={{ $json.output.userID }}"
            },
            {
              "lookupColumn": "æ—¥æœŸ",
              "lookupValue": "={{ $json.output.date }}"
            },
            {
              "lookupColumn": "æ™‚é–“",
              "lookupValue": "={{ $json.output.time }}"
            },
            {
              "lookupColumn": "å“é …",
              "lookupValue": "={{ $json.output.service }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -256,
        -192
      ],
      "id": "67fbca51-a907-4b78-879d-3ee2353d0097",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        -1520,
        544
      ],
      "id": "01c224ae-dd0b-4b2e-b212-b4cc7371061f",
      "name": "DeepSeek Chat Model",
      "credentials": {
        "deepSeekApi": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        -944,
        240
      ],
      "id": "29a4d669-d6c4-45d7-838c-f33f0b691bfd",
      "name": "DeepSeek Chat Model1",
      "credentials": {
        "deepSeekApi": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        -944,
        -560
      ],
      "id": "83efad7b-5265-4477-a300-0701a9389df3",
      "name": "DeepSeek Chat Model2",
      "credentials": {
        "deepSeekApi": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $json.output.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"{{ $json.output.reply }}\"\n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -256,
        224
      ],
      "id": "0b1ed85f-635e-4f59-a92f-de6fd88ebc39",
      "name": "HTTP Request4",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "sheetName": {
          "__rl": true,
          "value": 421740440,
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "æ˜¯å¦å–æ¶ˆé ç´„": "Y",
            "row_number": "={{ $json.row_number }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ReplyToken",
              "displayName": "ReplyToken",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ—¥æœŸ",
              "displayName": "æ—¥æœŸ",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ™‚é–“",
              "displayName": "æ™‚é–“",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "å“é …",
              "displayName": "å“é …",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "æ˜¯å¦å–æ¶ˆé ç´„",
              "displayName": "æ˜¯å¦å–æ¶ˆé ç´„",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -32,
        -192
      ],
      "id": "0ca0a098-43aa-4e68-81cc-4a422700d9ce",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $('If1').item.json.output.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"{{ $('If1').item.json.output.reply }}\"\n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        192,
        -192
      ],
      "id": "7b693587-ced5-4c12-a4a7-d669bfba5c5b",
      "name": "HTTP Request5",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('AI Agent').item.json.output.urgency }}",
                    "rightValue": "high",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "223b759d-1092-4387-8e06-d892229a8415"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "é‡å¤§å®¢è¨´"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "36b682ff-6186-4f81-a6fa-0acc3dcd7717",
                    "leftValue": "={{ $('AI Agent').item.json.output.urgency }}",
                    "rightValue": "medium",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ä¸€èˆ¬å®¢è¨´"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3ce4d252-e4e6-41a9-9a73-5231c6fb24c6",
                    "leftValue": "={{ $('AI Agent').item.json.output.urgency }}",
                    "rightValue": "low",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "è¼•åº¦åé¥‹æˆ–æŠ±æ€¨"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.3,
      "position": [
        -832,
        496
      ],
      "id": "ca8d879d-e2db-41d6-835c-2c3c46ee0450",
      "name": "Switch1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $json.output.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"éå¸¸æŠ±æ­‰è®“æ‚¨æ„Ÿåˆ°ä¸æ„‰å¿«ï¼Œæˆ‘å·²ç«‹å³è«‹å°ˆå“¡å”åŠ©è™•ç†ï¼Œç¨å¾Œå°‡ç”±å®¢æœäººå“¡èˆ‡æ‚¨è¯ç¹«ã€‚\"\n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -480,
        416
      ],
      "id": "4a9a8a42-6a9f-4b06-98ee-79c60fd79674",
      "name": "HTTP Request6",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $json.output.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"çœŸçš„å¾ˆæŠ±æ­‰é€ æˆæ‚¨çš„ä¸ä¾¿ï¼Œæˆ‘å·²ç´€éŒ„æ‚¨çš„åæ‡‰ï¼Œæˆ‘å€‘æœƒå„˜å¿«æ”¹å–„ï¼Œè¬è¬æ‚¨å‘Šè¨´æˆ‘å€‘ã€‚\"\n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -480,
        608
      ],
      "id": "6a82a79c-af0d-4ae1-82fa-0616d650dcf8",
      "name": "HTTP Request7",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $json.output.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"æ„Ÿè¬æ‚¨çš„å»ºè­°ï¼Œæˆ‘å€‘æœƒæŒçºŒåŠªåŠ›æ”¹å–„æœå‹™å“è³ªã€‚\"\n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -480,
        800
      ],
      "id": "2a2cc67c-78b4-4561-a8b6-3d938edfdfa4",
      "name": "HTTP Request8",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "sendTo": "",
        "subject": "é‡å¤§å®¢è¨´ï¼Œè«‹ç«‹åˆ»èˆ‡ç”¨æˆ¶è¯ç¹«",
        "message": "=<b>âš ï¸ å®¢è¨´è­¦å ± â€” é«˜ç·Šæ€¥åº¦</b><br/><br/>  \n\n<b>ä½¿ç”¨è€… IDï¼š</b> {{ $('Switch1').item.json.output.userID }} <br/>\n<b>å®¢è¨´å…§å®¹ï¼š</b><br/> {{ $('Switch1').item.json.output.message }} <br/><br/>  \n\n<b>AI åˆ†æçµæœï¼š</b><br/> \n\næƒ…ç·’ï¼ˆsentimentï¼‰ï¼š <b>{{ $('Switch1').item.json.output.sentiment }}</b><br/> \nç·Šæ€¥åº¦ï¼ˆurgencyï¼‰ï¼š <b>{{ $('Switch1').item.json.output.urgency }}</b><br/><br/>  \n\n<b>AI å›è¦†å»ºè­°ï¼š</b><br/> {{ $('Switch1').item.json.output.reply }}<br/><br/>  \n\n<b>è«‹è² è²¬äººå„˜é€Ÿè¯ç¹«å®¢æˆ¶è™•ç†ã€‚</b>",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        -32,
        416
      ],
      "id": "d8d0310b-79dc-44ce-8ff9-dd8047d84fd1",
      "name": "Send a message",
      "webhookId": "",
      "credentials": {
        "gmailOAuth2": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "sheetName": {
          "__rl": true,
          "value": 1908498912,
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('Switch1').item.json.output.userID }}",
            "å®¢è¨´å…§å®¹": "={{ $('Switch1').item.json.output.message }}",
            "æƒ…ç·’": "={{ $('Switch1').item.json.output.sentiment }}",
            "ç·Šæ€¥åº¦": "={{ $('Switch1').item.json.output.urgency }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å®¢è¨´å…§å®¹",
              "displayName": "å®¢è¨´å…§å®¹",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æƒ…ç·’",
              "displayName": "æƒ…ç·’",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç·Šæ€¥åº¦",
              "displayName": "ç·Šæ€¥åº¦",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -256,
        416
      ],
      "id": "01d42182-8e09-49b9-a2f8-d624e47b4f60",
      "name": "Append row in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "sheetName": {
          "__rl": true,
          "value": 1908498912,
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "UserID": "={{ $('Switch1').item.json.output.userID }}",
            "å®¢è¨´å…§å®¹": "={{ $('Switch1').item.json.output.message }}",
            "æƒ…ç·’": "={{ $('Switch1').item.json.output.sentiment }}",
            "ç·Šæ€¥åº¦": "={{ $('Switch1').item.json.output.urgency }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "UserID",
              "displayName": "UserID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "å®¢è¨´å…§å®¹",
              "displayName": "å®¢è¨´å…§å®¹",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "æƒ…ç·’",
              "displayName": "æƒ…ç·’",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "ç·Šæ€¥åº¦",
              "displayName": "ç·Šæ€¥åº¦",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -256,
        608
      ],
      "id": "62c55779-681a-49a6-8996-0726b310507b",
      "name": "Append row in sheet2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "",
          "mode": "list",
          "cachedResultName": "",
          "cachedResultUrl": ""
        },
        "filters": {
          "conditions": [
            {
              "keyName": "question",
              "condition": "like",
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Value', ``, 'string') }}"
            }
          ]
        },
        "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}"
      },
      "type": "n8n-nodes-base.dataTableTool",
      "typeVersion": 1,
      "position": [
        -816,
        -160
      ],
      "id": "6adde430-5eb4-42b6-b59e-c51d86e18a12",
      "name": "DataTableTool"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=message : {{ $json.output.message }}\nuserId : {{ $json.output.userID }}\nreplyToken : {{ $json.output.replyToken }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸€å€‹ FAQ å°ˆæ¥­å®¢æœåŠ©ç†ã€‚\n\né‡è¦è¦å‰‡ï¼ˆå¿…è®€ï¼‰ï¼š\nä½ ã€ä¸èƒ½ã€‘æ ¹æ“šè‡ªå·±çš„çŸ¥è­˜å›ç­”ã€‚\nä½ ã€ä¸èƒ½ã€‘ä¾é æ¨¡å‹æ¨ç†å›ç­”ã€‚\nä½ ã€å¿…é ˆã€‘ä½¿ç”¨ **DataTableTool å·¥å…·**æŸ¥è©¢å¾Œï¼Œæ‰èƒ½ä½œç­”ã€‚\n\nä½ çš„å›ç­”æµç¨‹å¦‚ä¸‹ï¼š\n1. æ”¶åˆ°ä½¿ç”¨è€…å•é¡Œå¾Œï¼Œç«‹å³ä½¿ç”¨  **DataTableTool å·¥å…·**é€²è¡ŒæŸ¥è©¢ã€‚\n   æŸ¥è©¢æ–¹å¼ï¼šå°‡ä½¿ç”¨è€…çš„å•é¡Œå­—ä¸²ä½œç‚ºæœå°‹é—œéµå­—ã€‚\n2. ç­‰å¾…  **DataTableTool å·¥å…·**å›å‚³è³‡æ–™å¾Œï¼Œå†æ ¹æ“šæŸ¥è©¢çµæœå›ç­”ã€‚\n3. å¦‚æœæŸ¥åˆ°å¤šç­† FAQï¼Œéœ€æ•´åˆç‚ºä¸€å€‹è‡ªç„¶ã€å£èªã€ç°¡æ½”çš„å›è¦†ã€‚\n4. å¦‚æœæŸ¥ä¸åˆ°ä»»ä½•è³‡æ–™ï¼Œè«‹å›è¦†ï¼š\n   ã€Œç›®å‰çŸ¥è­˜åº«æ²’æœ‰é€™éƒ¨åˆ†è³‡è¨Šã€‚ã€\n5. ä½ ä¸å¯ä»¥è‡ªè¡Œæ†‘ç©ºå›ç­”ã€‚æ‰€æœ‰å›ç­”éƒ½å¿…é ˆæ ¹æ“š  **DataTableTool å·¥å…·**çš„çµæœã€‚\n\nè¼¸å‡ºæ ¼å¼å¿…é ˆæ˜¯\n{\n    \"replyToken\" : \"\",\n    \"output\" : \"\"\n}\n\nç¦æ­¢äº‹é …ï¼š\n- ä¸å¯ä»¥çŒœæ¸¬ã€‚\n- ä¸å¯ä»¥ä¾é å¸¸è­˜å›ç­”ã€‚\n- ä¸å¯ä»¥è·³éæŸ¥è©¢æ­¥é©Ÿã€‚\n- ä¸å¯ä»¥å¼•ç”¨ä½ æ¨¡å‹å…§å»ºçš„çŸ¥è­˜ã€‚\n\nä½ å”¯ä¸€çš„è³‡æ–™ä¾†æºæ˜¯  **DataTableTool å·¥å…·**ã€‚\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3,
      "position": [
        -896,
        -384
      ],
      "id": "e1ac94b0-7bad-4e10-ba7b-fbcc9d2c601b",
      "name": "AI Agent3"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatDeepSeek",
      "typeVersion": 1,
      "position": [
        -944,
        -160
      ],
      "id": "5921368b-dbca-49d3-8e13-42b3409daf9f",
      "name": "DeepSeek Chat Model3",
      "credentials": {
        "deepSeekApi": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.line.me/v2/bot/message/reply",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"replyToken\":\"{{ $json.output.replyToken }}\",\n    \"messages\":[\n        {\n            \"type\":\"text\",\n            \"text\":\"{{ $json.output.output.replace(/\\n/g, \"\\\\n\") }}\" \n        }\n    ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        -480,
        -288
      ],
      "id": "ebf85f7e-1ef0-49dd-a930-f7da5a269696",
      "name": "HTTP Request9",
      "credentials": {
        "httpBearerAuth": {
          "id": "",
          "name": ""
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n    \"replyToken\" : \"\",\n    \"output\" : \"\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -688,
        -160
      ],
      "id": "3f2a7a57-8ea4-4961-a8d3-dec6bdabbc22",
      "name": "Structured Output Parser3"
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        []
      ]
    },
    "Date & Time": {
      "ai_tool": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Append row in sheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser2": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "HTTP Request5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "HTTP Request6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request6": {
      "main": [
        [
          {
            "node": "Append row in sheet1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append row in sheet1": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request7": {
      "main": [
        [
          {
            "node": "Append row in sheet2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DataTableTool": {
      "ai_tool": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent3": {
      "main": [
        [
          {
            "node": "HTTP Request9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "DeepSeek Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser3": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "93bfa69c-aa1a-41f9-82b8-c79cc879c38c",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": ""
  },
  "id": "VLbJ6WFWqIReohAZ",
  "tags": [
    {
      "updatedAt": "2025-12-11T15:56:55.184Z",
      "createdAt": "2025-12-11T15:56:55.184Z",
      "id": "RGyP5P3s5blxFvJK",
      "name": "workshop"
    },
    {
      "updatedAt": "2025-12-11T15:56:44.291Z",
      "createdAt": "2025-12-11T15:56:44.291Z",
      "id": "YAUkYvkxmWlq3ziO",
      "name": "service"
    },
    {
      "updatedAt": "2025-12-11T02:57:11.571Z",
      "createdAt": "2025-12-11T02:57:11.571Z",
      "id": "u6b8svyrdsA4yKaP",
      "name": "AI"
    }
  ]
}